@use "sass:color";
@use "viz-mixins";

$bg-color: #191919;
$base-color: #222222;
$text-color: #f7f9f9;
$primary-color: #1885df;
$secondary-color: #06589b;

:root {
    --viz-bg-color: #{$bg-color};
    --viz-text-color: #{$text-color};
    --viz-primary: #{$primary-color};
    --viz-secondary: #{$secondary-color};

    @include viz-mixins.generate-viz-colors(
        $bg-color: $bg-color,
        $text-color: $text-color,
        $base-color: $base-color,
        $is-light-theme: true,
        $flip-bg-color: white,
        $flip-bg-pct: 0%,
        $flip-text-color: black,
        $flip-text-pct: 15%,
        $suffix: "-light"
    );

    @include viz-mixins.generate-viz-colors(
        $bg-color: $bg-color,
        $text-color: $text-color,
        $base-color: $base-color,
        $is-light-theme: false,
        $suffix: "-dark"
    );
}

@mixin viz-theme($sel, $is-light, $flip-bg: null, $flip-bg-pct: 0%, $flip-text: null, $flip-text-pct: 0%) {
    #{$sel} {
        @include viz-mixins.generate-viz-colors(
            $bg-color: $bg-color,
            $text-color: $text-color,
            $base-color: $base-color,
            $is-light-theme: $is-light,
            $flip-bg-color: $flip-bg,
            $flip-bg-pct: $flip-bg-pct,
            $flip-text-color: $flip-text,
            $flip-text-pct: $flip-text-pct
        );
    }
}

/* Light theme: use a blue base so --viz-100 is the lightest blue and
   --viz-10 is the darkest (in 10% steps). */
$light-theme-sel: ':root[data-theme="light"], [data-theme="light"]';
@include viz-theme($light-theme-sel, true, white, 0%, black, 15%);

/* Dark theme: opposite mapping so --viz-100 is the darkest (base 100%) and
   --viz-10 is lightest. */
@include viz-theme(':root[data-theme="dark"], [data-theme="dark"]', false);

/* If user prefers dark and no explicit theme is set, generate dark palette */
@media (prefers-color-scheme: dark) {
    @include viz-theme(":root:not([data-theme])", false);
}

/* If user prefers light and no explicit theme is set, generate light palette */
@media (prefers-color-scheme: light) {
    @include viz-theme($light-theme-sel, true, white, 0%, black, 15%);
}
