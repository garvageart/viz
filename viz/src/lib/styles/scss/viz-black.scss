@use "sass:color";

$bg-color: #222222;
$base-color: #333333;
$text-color: #F7F9F9;
$primary-color: #1885df;
$secondary-color: #06589b;

:root {
    --imag-bg-color: #{$bg-color};
    --imag-text-color: #{$text-color};
    --imag-primary: #{$primary-color};
    --imag-secondary: #{$secondary-color};
}

/// Generates the --imag-XX color palette (10% to 100% steps).
///
/// @param {Color} $bg-color - The theme's background color.
/// @param {Color} $text-color - The theme's text color.
/// @param {Color} $base-color - The color used for the step mixing (e.g., blue for light theme, dark blue for dark theme).
/// @param {boolean} $is-light-theme [false] - If true, 100% is the lightest mix; if false, 100% is the darkest/base.
@mixin generate-imag-colors($bg-color,
    $text-color,
    $base-color,
    $is-light-theme: false,
    $flip-bg-color: null,
    $flip-bg-pct: 0%,
    $flip-text-color: null,
    $flip-text-pct: 0%) {
    // optionally mix the provided flip colors into the bg/text
    $out-bg-color: if($flip-bg-color !=null, color.mix($bg-color, $flip-bg-color, $flip-bg-pct), $bg-color);
    $out-text-color: if($flip-text-color !=null, color.mix($text-color, $flip-text-color, $flip-text-pct), $text-color);

    --imag-bg-color: #{$out-bg-color};
    --imag-text-color: #{$out-text-color};

    $pct: 0%;

    @for $j from 0 through 9 {
        $level: 100 - $j * 10;

        @if $is-light-theme {
            $pct: (
                10 + $j * 10) * 1%;
        }

        @else {
            $pct: (
                100 - $j * 10) * 1%;
        }

        --imag-#{$level}: #{color.mix($base-color, white, $pct)};
    }
}

/* Colours */

/* Light theme: use a blue base so --imag-100 is the lightest blue and
   --imag-10 is the darkest (in 10% steps). */
:root[data-theme="light"],
[data-theme="light"] {
    @include generate-imag-colors($bg-color: $bg-color,
        $text-color: $text-color,
        $base-color: $base-color,
        $is-light-theme: true,
        $flip-bg-color: rgb(230, 231, 242),
        $flip-bg-pct: 5%,
        $flip-text-color: black,
        $flip-text-pct: 7%
);
}

/* Dark theme: opposite mapping so --imag-100 is the darkest (base 100%) and
   --imag-10 is lightest. */
:root[data-theme="dark"],
[data-theme="dark"] {
    @include generate-imag-colors($bg-color: $bg-color,
        $text-color: $text-color,
        $base-color: $base-color,
        $is-light-theme: false);
}

/* If user prefers dark and no explicit theme is set, default to dark values */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
        --imag-bg-color: #{$bg-color};
        --imag-text-color: #{$text-color};
    }
}

/* Up */
::-webkit-scrollbar-button:single-button:vertical:decrement {
    height: 12px;
    width: 16px;
    background-position: center 4px;
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' fill='var(--imag-20)'><polygon points='50,00 0,50 100,50'/></svg>");
}

::-webkit-scrollbar-button:single-button:vertical:decrement:hover {
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' fill='var(--imag-90)'><polygon points='50,00 0,50 100,50'/></svg>");
}

::-webkit-scrollbar-button:single-button:vertical:decrement:active {
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' fill='var(--imag-100)'><polygon points='50,00 0,50 100,50'/></svg>");
}

/* Down */
::-webkit-scrollbar-button:single-button:vertical:increment {
    height: 12px;
    width: 16px;
    background-position: center 2px;
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' fill='var(--imag-20)'><polygon points='0,0 100,0 50,50'/></svg>");
}

::-webkit-scrollbar-button:single-button:vertical:increment:hover {
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' fill='var(--imag-90)'><polygon points='0,0 100,0 50,50'/></svg>");
}

::-webkit-scrollbar-button:single-button:vertical:increment:active {
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' fill='var(--imag-100)'><polygon points='0,0 100,0 50,50'/></svg>");
}